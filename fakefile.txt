Style fixes 1-1
Minor changes 2-1
Improve performance 3-1
Fix bug 3-2
Minor changes 3-3
